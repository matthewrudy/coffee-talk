<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
	<title>Coffee</title>
	<meta name="author" content="Matthew Rudy Jacobs" />
	<meta name="email" content="MatthewRudyJacobs@gmail.com" />
	<meta name="venue" content="Hong Kong Ruby Group April 2011" />
	<meta name="date" content="Friday 29th April 2011" />

	<link type="text/css" rel="stylesheet" href="stylesheets/slippy.css"/>
	<link type="text/css" rel="stylesheet" href="stylesheets/slippy-dark.css"/>
	
	<link type="text/css" rel="stylesheet" href="stylesheets/shCore.css"/>
	<link type="text/css" rel="stylesheet" href="stylesheets/shThemeMidnight.css"/>

	<!-- Slippy core file and dependencies -->
	<script type="text/javascript" src="javascripts/jquery.min.js"></script>
	<script type="text/javascript" src="javascripts/jquery.history.js"></script>
	<script type="text/javascript" src="javascripts/slippy.js"></script>
	
	<script type="text/javascript" src="javascripts/shCore.js"></script>
	<script type="text/javascript" src="javascripts/shBrushRuby.js"></script>
	
	<style type="text/css">
	  .slide pre {
	    font-size : 0.7em;
	  }
	  .slide pre.big {
	    font-size : 1.0em;
	  }
	  .slide pre.smaller {
	    font-size : 0.75em;
	  }
	  .slide pre.smallest {
	    font-size : 0.3em;
	  }
	  h1 {
	    font-size : 2.5em;
	  }
	  h1.extra {
	    font-size : 3.5em;
	  }
	  li {
	    padding : 0.5em 0;
	  }
	  #background {
	    color : #333;
	  }
	</style>

	<!-- Slippy init code -->
	<script type="text/javascript">
	$(function() {
		$(".slide").slippy({widthInCharacters: 20});
	});
	</script>
</head>
<body>
	<div class="slide">
	  <h1>Coffee</h1>
	  <p>Hong Kong Ruby Group</p>
	  <p>Friday 29th April 2011</p>
	</div>
	
	<div class="slide">
	  <h1 style="font-size:1000% ;margin:0">âœŒ</h1>
	</div>
	
	<div class="slide">
	  <h1>I'm addicted to Coffee</h1>
	  <h1 class="incremental">The Drink</h1>
	</div>
	
	<div class="slide">
	  <h1>What is Coffee?</h1>
	  <h2>A programming language</h2>
	</div>
	
	<div class="slide">
	  <h1>Key Features</h1>
  </div>
  
  <div class="slide">
	  <h2>Functions</h2>
	  <pre class="massive">
# single line
sayOnce = (word) -> word

# multilines
sayThrice = (word) ->
  word +
  word +
  word
  
# with no arguments
fortyTwo = -> 42

# with no body
blackHole = (input)->

# with nothing
nothing = ->
    </pre>
  </div>
  
  <div class="slide">
    <h2>If Statements</h2>
    <pre>
# inline
commitName = if pairing then pairName else myName

# multiline
hardcore = if commitCount > 1000
  "definitely"
else if nickname.leet()
  "possibly"
else
  "no"
    </pre>
  </div>
  
  <div class="slide">
    <h2>Case Statements</h2>
    <pre>
maritalStatus = switch numberOfWives
  when 0 then "single"
  when 1 then "married"
  when 2 then "bigamist"
  when 3,4,5 then "polygamist"
  else "undefined"
    </pre>
  </div>
  
  <div class="slide">
    <h2>List Comprehensions</h2>
    <pre>
# kind of like map
("Mrs #{name}" for name in ["A", "B", "C"])

# but we can step it
(n*n for n in [2..10] by 2)

# or guard it
(n*n for n in [1..10] when n%2==0)
    </pre>
  </div>
  
  <div class="slide">
	  <h2>Splats</h2>
	  <pre class="massive">
# splat everything
sayWords = (words...) ->
  words.join(", ")
  
# splat at the end
places = (first, second, rest...) ->
  """
  first:  #{first}
  second: #{second}
  reset:  #{rest}
  """
  
# splat in the middle
split = (first, middle..., last) ->
  "first was #{first}"
    </pre>
  </div>
  
  <div class="slide">
	  <h2>Ruby-style String Interpolation</h2>
	  <pre class="massive">
# "hello"
hello = "hello"

# "say hello"
sayHello = "say #{hello}"

# "say hello hello"
helloHello = "#{sayHello} #{hello}"

# "dont #{sayHello}"
notInterpolated = 'dont #{sayHello}'
    </pre>
  </div>
  
  <div class="slide">
	  <h2>Classes</h2>
	  <pre class="massive">
# define a class
class User

  # define the constructor
  constructor: (name) -> name = @name
  
# create an instance
raffi = new User "Raffi"

# extend it
class AdminUser extends User

# extend it again
class SuperAdminUser extends AdminUser

superman = new SuperAdminUser "Super Man"
    </pre>
  </div>
  
  <div class="slide">
	  <h2>Super</h2>
	  <pre class="massive">
# define a class
class Child
  constructor: (@name, @age) ->
  
  sayName: -> "My name is #{@name}"

# and a subclass with a difference
class CleverChild

  # say it
  sayName: -> super() +
  
    # then be a bit smart
    " and I am #{@age} years old"
    </pre>
  </div>
  
  <div class="slide">
	  <h2>Instance Variables</h2>
	  <pre class="massive">
class Monkey
  # explicit assignment
  constructor: (food) -> 
    @favouriteFood = food 
  
me = new Monkey "Banana"
me.favouriteFood # "Banana"

class Giraffe
  # argument assignment
  constructor: (@favouriteFood) ->
  
you = new Giraffe "Leaves"
you.favouriteFood # "Leaves"
    </pre>
  </div>
  
  <div class="slide">
    <h2>The "Existential Operator"</h2>
    <pre>
# value.present?
value?

# value || default
value ? default

# value ||= default
value ?= default

# value && value.someMethod
value?.someMethod()
    </pre>
  </div>
  
  <div class="slide">
	  <h2>A load of other cool stuff</h2>
	  <pre class="massive">
# chained comparisons
isTeenager = (age) -> 20 > age > 12

# multiple assignment
[a,b] = [1,2]

# monkeypatching
String::dasherize = ->
  this.replace /_/g, "-"
  
# argument defaults
speakTo = (person, say="Hello") ->
  "#{say} #{person}"
    </pre>
  </div>
  
  <div class="slide">
    <h1>Pretty Cool</h1>
    <h1>Huh?</h1>
  </div>
  
  <div class="slide">
    <h1>Except</h1>
    <h2>This is all turned into (sometimes nasty) Javascript</h2>
    <p class="incremental">cue: looking at the previous code, once translated</p>
  </div>
  
  <div class="slide">
    <h1>Using it in Rails</h1>
    <a href="https://gist.github.com/923998">https://gist.github.com/923998</a>
  </div>
  
  <div class="slide">
    <h2>Gemfile</h2>
    <pre>
gem 'coffee-script'
gem 'yui-compressor', :require => 'yui/compressor'
gem 'json'
gem 'sprockets'
	  </pre>
	</div>
	
	<div class="slide">
	  <h2>Initializer</h2>
	  <pre>
class AssetServer < Sprockets::Environment
  include Singleton

  def initialize
    super Rails.root.join('app', 'assets')
    paths << 'javascripts'
    if Rails.env.production?
      self.js_compressor = YUI::JavaScriptCompressor.new(
        :munge => true,
        :optimize => true
      )
    end
  end

end
    </pre>
  </div>
  
  <div class="slide">
    <h2>Routes</h2>
    <pre>
CoffeeExample::Application.routes.draw do
  root :to => "home#index"

  # Mount the rack end-point for JavaScript.
  mount AssetServer.instance => '/assets'
end
    </pre>
  </div>
  
  <div class="slide">
    <h2>app/assets/javascripts</h2>
    <pre>
# application.js
//= require jquery
//= require jquery_ujs
//= require_tree .

# some.coffee
class Gobby
  constructor: (@name) ->
  
  speak: -> alert("I am #{name}")
  
$(document).ready ->
  gobby = new Gobby "Jobby"
  gobby.speak()
  
    </pre>
  </div>
  
  <div class="slide">
    <h1>Examples</h1>
  </div>
  
  <div class="slide">
    <h2>Original</h2>
    <pre>
var CURRENCIES = {
  HKD: {
    num: 344,
    e: 2,
    currency: "Hong Kong dollar"
  },
  SGD: {
    num: 702,
    e: 2, 
    currency: "Singapore dollar"
  }
};

function find_currency(code) {
  return CURRENCIES[code];
}
    </pre>
  </div>
  
  <div class="slide">
    <h2>Coffee</h2>
    <pre>
CURRENCIES =
  HKD:
    num: 344
    e: 2
    currency: "Hong Kong dollar"
  SGD:
    num: 702
    e: 2
    currency: "Singpore dollar"

findCurrency = (code) ->
  CURRENCIES[code]
    </pre>
  </div>
  
  <div class="slide">
    <h2>Generated</h2>
    <pre>
var CURRENCIES, findCurrency;
CURRENCIES = {
  HKD: {
    num: 344,
    e: 2,
    currency: "Hong Kong dollar"
  },
  SGD: {
    num: 702,
    e: 2,
    currency: "Singpore dollar"
  }
};

findCurrency = function(code) {
  return CURRENCIES[code];
};
    </pre>
  </div>
    
  <div class="slide">
    <h2>Original</h2>
    <pre>
$(document).ready( function(){
    $(".slider").each(function() {
      var slideContainer = $(this);
      
      var slideClicker = slideContainer.find(".slide_label");
      var slideBody    = slideContainer.find(".slide_body");
      
      // if javascript is enabled we'll hide the body
      slideContainer.find(".slide_body").css({"display": "none"});

      slideClicker.click(function() {
        slideBody.toggle();
      });
    });
});
    </pre>
  </div>

  <div class="slide">
    <h2>Coffee</h2>
    <pre>
$(document).ready ->
  $(".slider").each ->
    slideContainer = $(this)

    slideClicker = slideContainer.find(".slide_label")
    slideBody    = slideContainer.find(".slide_body")

    slideContainer.find(".slide_body").css display: "none"
    slideClicker.click ->
      slideBody.toggle()
    </pre>
  </div>

  <div class="slide">
    <h2>Generated</h2>
    <pre>
$(document).ready(function() {
  return $(".slider").each(function() {
    var slideBody, slideClicker, slideContainer;
    slideContainer = $(this);
    slideClicker = slideContainer.find(".slide_label");
    slideBody = slideContainer.find(".slide_body");
    slideContainer.find(".slide_body").css({
      display: "none"
    });
    return slideClicker.click(function() {
      return slideBody.toggle();
    });
  });
});
    </pre>
  </div>
  
  
  <div class="slide">
    <h2>Coffee</h2>
    <pre class="smaller">
SPIES = [
  {name: "Matthew", spy: no}
  {name: "Steve",   spy: yes}
  {name: "Eddie",   spy: no}
]

Array::detect = (func) ->
  for element in this
    if func(element)
      return element

Array::select = (func) ->
  (element for element in this when func(element))

theSpy   = SPIES.detect (person) -> person.spy == true
nonSpies = SPIES.select (person) -> person.spy != true
    </pre>
  </div>

  <div class="slide">
    <h2>Generated</h2>
    <pre class="smallest">
var SPIES, nonSpies, theSpy;
SPIES = [
  {
    name: "Matthew",
    spy: false
  }, {
    name: "Steve",
    spy: true
  }, {
    name: "Eddie",
    spy: false
  }
];
Array.prototype.detect = function(func) {
  var element, _i, _len;
  for (_i = 0, _len = this.length; _i < _len; _i++) {
    element = this[_i];
    if (func(element)) {
      return element;
    }
  }
};
Array.prototype.select = function(func) {
  var element, _i, _len, _results;
  _results = [];
  for (_i = 0, _len = this.length; _i < _len; _i++) {
    element = this[_i];
    if (func(element)) {
      _results.push(element);
    }
  }
  return _results;
};
theSpy = SPIES.detect(function(person) {
  return person.spy === true;
});
nonSpies = SPIES.select(function(person) {
  return person.spy !== true;
});
    </pre>
  </div>
  
</body>
</html>
